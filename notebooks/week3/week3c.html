

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>5. Introduction to Brian part 3: Simulations &#8212; Computational Neuroscience</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/week3/week3c';</script>
    <link rel="canonical" href="https://neurowithpython.com/notebooks/week3/week3c.html" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6. Introduction to Data Analysis with Pandas" href="../week4/week4a.html" />
    <link rel="prev" title="4. Introduction to Brian part 2: Synapses" href="week3b.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/cajal1.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/cajal1.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Course overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding tools for researchers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week0/codingtoolsforresearch.html">Coding tools for researchers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1. Math review with Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week1/week1-IntroColab.html">Google’s Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1/week1a-Numpy_Introduction.html">Introduction to NumPy and Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1/week1b-Linear_Algebra.html">Linear Algebra basics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2. Differential equations and neuron models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week2/week2a.html">1. Introduction modelling with differential equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/week2b-Applications_LT.html">2. Dynamical systems as Linear Transformations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3. Simulation of neural population</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week3a.html">3. Introduction to Brian part 1: Neurons</a></li>
<li class="toctree-l1"><a class="reference internal" href="week3b.html">4. Introduction to Brian part 2: Synapses</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Introduction to Brian part 3: Simulations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4. Data analysis and Machine learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week4/week4a.html">6. Introduction to Data Analysis with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/week4b.html">7. Machine Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5. Reinforcement Learning and Control Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week5/CT.html">8. Control Theory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6. Network analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week6/week6.html">9. Network science</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/BergLab/CompNeuroBook/blob/master/docs/notebooks/week3/week3c.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BergLab/CompNeuroBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BergLab/CompNeuroBook/edit/master/docs/notebooks/week3/week3c.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BergLab/CompNeuroBook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/week3/week3c.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/week3/week3c.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to Brian part 3: Simulations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-runs">5.1. Multiple runs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-things-during-a-run">5.2. Changing things during a run</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-input">5.3. Adding input</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-brian-part-3-simulations">
<h1><span class="section-number">5. </span>Introduction to Brian part 3: Simulations<a class="headerlink" href="#introduction-to-brian-part-3-simulations" title="Permalink to this heading">#</a></h1>
<p>*Credit: The first three notebooks from week3 are part of the <span class="xref myst">Brian2 documentation</span>.</p>
<p>If you haven’t yet read parts 1 and 2 on Neurons and Synapses, go read them first.</p>
<p>This tutorial is about managing the slightly more complicated tasks that crop up in research problems, rather than the toy examples we’ve been looking at so far. So we cover things like inputting sensory data, modelling experimental conditions, etc.</p>
<p>As before we start by importing the Brian package and setting up matplotlib for IPython:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>brian2
<span class="kn">from</span> <span class="nn">brian2</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Skipping /usr/local/lib/python3.11/site-packages/six-1.16.0-py3.11.egg-info due to invalid metadata entry &#39;name&#39;</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Skipping /usr/local/lib/python3.11/site-packages/six-1.16.0-py3.11.egg-info due to invalid metadata entry &#39;name&#39;</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: brian2 in /usr/local/lib/python3.11/site-packages (2.5.1)
Requirement already satisfied: numpy&gt;=1.17 in /usr/local/lib/python3.11/site-packages (from brian2) (1.24.2)
Requirement already satisfied: cython&gt;=0.29 in /usr/local/lib/python3.11/site-packages (from brian2) (0.29.34)
Requirement already satisfied: sympy&gt;=1.2 in /usr/local/lib/python3.11/site-packages (from brian2) (1.11.1)
Requirement already satisfied: pyparsing in /usr/local/Cellar/graph-tool/2.46/libexec/lib/python3.11/site-packages (from brian2) (3.0.9)
Requirement already satisfied: jinja2&gt;=2.7 in /usr/local/lib/python3.11/site-packages (from brian2) (3.1.2)
Requirement already satisfied: setuptools&gt;=24.2 in /usr/local/lib/python3.11/site-packages (from brian2) (65.6.3)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.11/site-packages (from jinja2&gt;=2.7-&gt;brian2) (2.1.2)
Requirement already satisfied: mpmath&gt;=0.19 in /usr/local/lib/python3.11/site-packages (from sympy&gt;=1.2-&gt;brian2) (1.3.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Skipping /usr/local/lib/python3.11/site-packages/six-1.16.0-py3.11.egg-info due to invalid metadata entry &#39;name&#39;</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Skipping /usr/local/lib/python3.11/site-packages/six-1.16.0-py3.11.egg-info due to invalid metadata entry &#39;name&#39;</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Skipping /usr/local/lib/python3.11/site-packages/six-1.16.0-py3.11.egg-info due to invalid metadata entry &#39;name&#39;</span>
<span class=" -Color -Color-Yellow">WARNING: Skipping /usr/local/lib/python3.11/site-packages/six-1.16.0-py3.11.egg-info due to invalid metadata entry &#39;name&#39;</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip available: <span class=" -Color -Color-Red">22.3.1</span> -&gt; <span class=" -Color -Color-Green">23.0.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">python3.11 -m pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<section id="multiple-runs">
<h2><span class="section-number">5.1. </span>Multiple runs<a class="headerlink" href="#multiple-runs" title="Permalink to this heading">#</a></h2>
<p>Let’s start by looking at a very common task: doing multiple runs of a simulation with some parameter that changes. Let’s start off with something very simple, how does the firing rate of a leaky integrate-and-fire neuron driven by Poisson spiking neurons change depending on its membrane time constant? Let’s set that up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remember, this is here for running separate simulations in the same notebook</span>
<span class="n">start_scope</span><span class="p">()</span> 
<span class="c1"># Parameters</span>
<span class="n">num_inputs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">input_rate</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Hz</span>
<span class="n">weight</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="c1"># Range of time constants</span>
<span class="n">tau_range</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">ms</span>
<span class="c1"># Use this list to store output rates</span>
<span class="n">output_rates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Iterate over range of time constants</span>
<span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">tau_range</span><span class="p">:</span>
    <span class="c1"># Construct the network each time</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">input_rate</span><span class="p">)</span>
    <span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    dv/dt = -v/tau : 1</span>
<span class="s1">    &#39;&#39;&#39;</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;v += weight&#39;</span><span class="p">)</span>
    <span class="n">S</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="c1"># Run it and store the output firing rate in the list</span>
    <span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">second</span><span class="p">)</span>
    <span class="n">output_rates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">num_spikes</span><span class="o">/</span><span class="n">second</span><span class="p">)</span>
<span class="c1"># And plot it</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tau_range</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">output_rates</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$ (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing rate (sp/s)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">23</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>     <span class="n">M</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="c1"># Run it and store the output firing rate in the list</span>
<span class="ne">---&gt; </span><span class="mi">23</span>     <span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">second</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="n">output_rates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">num_spikes</span><span class="o">/</span><span class="n">second</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="c1"># And plot it</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/units/fundamentalunits.py:2462,</span> in <span class="ni">check_units.&lt;locals&gt;.do_check_units.&lt;locals&gt;.new_f</span><span class="nt">(*args, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">2455</span>             <span class="n">error_message</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2456</span>                              <span class="sa">f</span><span class="s2">&quot;expected a quantitity with unit &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2457</span>                              <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2"> for argument &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; but got &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2458</span>                              <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2459</span>             <span class="k">raise</span> <span class="n">DimensionMismatchError</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2460</span>                                          <span class="n">get_dimensions</span><span class="p">(</span><span class="n">newkeyset</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
<span class="ne">-&gt; </span><span class="mi">2462</span> <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2463</span> <span class="k">if</span> <span class="s1">&#39;result&#39;</span> <span class="ow">in</span> <span class="n">au</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2464</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">au</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">],</span> <span class="n">Callable</span><span class="p">)</span> <span class="ow">and</span> <span class="n">au</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/core/magic.py:377,</span> in <span class="ni">run</span><span class="nt">(duration, report, report_period, namespace, profile, level)</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span> <span class="nd">@check_units</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">second</span><span class="p">,</span> <span class="n">report_period</span><span class="o">=</span><span class="n">second</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span> <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report_period</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">second</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>         <span class="n">profile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span><span class="sd">     run(duration, report=None, report_period=10*second, namespace=None, level=0)</span>
<span class="g g-Whitespace">    </span><span class="mi">315</span><span class="sd">     </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span><span class="sd">         intended use. See `MagicNetwork` for more details.</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">377</span>     <span class="k">return</span> <span class="n">magic_network</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="n">report</span><span class="p">,</span> <span class="n">report_period</span><span class="o">=</span><span class="n">report_period</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>                              <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">level</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/core/magic.py:230,</span> in <span class="ni">MagicNetwork.run</span><span class="nt">(self, duration, report, report_period, namespace, profile, level)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span> <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report_period</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">second</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>         <span class="n">namespace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_update_magic_objects</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">230</span>     <span class="n">Network</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="n">report</span><span class="p">,</span> <span class="n">report_period</span><span class="o">=</span><span class="n">report_period</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>                 <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/core/base.py:293,</span> in <span class="ni">device_override.&lt;locals&gt;.device_override_decorator.&lt;locals&gt;.device_override_decorated_function</span><span class="nt">(*args, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span>     <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">curdev</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">293</span>     <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/units/fundamentalunits.py:2462,</span> in <span class="ni">check_units.&lt;locals&gt;.do_check_units.&lt;locals&gt;.new_f</span><span class="nt">(*args, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">2455</span>             <span class="n">error_message</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2456</span>                              <span class="sa">f</span><span class="s2">&quot;expected a quantitity with unit &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2457</span>                              <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2"> for argument &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; but got &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2458</span>                              <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2459</span>             <span class="k">raise</span> <span class="n">DimensionMismatchError</span><span class="p">(</span><span class="n">error_message</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2460</span>                                          <span class="n">get_dimensions</span><span class="p">(</span><span class="n">newkeyset</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
<span class="ne">-&gt; </span><span class="mi">2462</span> <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2463</span> <span class="k">if</span> <span class="s1">&#39;result&#39;</span> <span class="ow">in</span> <span class="n">au</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2464</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">au</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">],</span> <span class="n">Callable</span><span class="p">)</span> <span class="ow">and</span> <span class="n">au</span><span class="p">[</span><span class="s1">&#39;result&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/core/network.py:1007,</span> in <span class="ni">Network.run</span><span class="nt">(self, duration, report, report_period, namespace, profile, level)</span>
<span class="g g-Whitespace">   </span><span class="mi">1004</span> <span class="k">if</span> <span class="n">namespace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1005</span>     <span class="n">namespace</span> <span class="o">=</span> <span class="n">get_local_namespace</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1007</span> <span class="bp">self</span><span class="o">.</span><span class="n">before_run</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_objects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1010</span>     <span class="k">return</span>  <span class="c1"># TODO: raise an error? warning?</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/core/base.py:293,</span> in <span class="ni">device_override.&lt;locals&gt;.device_override_decorator.&lt;locals&gt;.device_override_decorated_function</span><span class="nt">(*args, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">291</span>     <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">curdev</span><span class="p">,</span> <span class="n">name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">292</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">293</span>     <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/core/network.py:892,</span> in <span class="ni">Network.before_run</span><span class="nt">(self, run_namespace)</span>
<span class="g g-Whitespace">    </span><span class="mi">890</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">891</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">892</span>         <span class="n">obj</span><span class="o">.</span><span class="n">before_run</span><span class="p">(</span><span class="n">run_namespace</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">893</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">894</span>         <span class="k">raise</span> <span class="n">BrianObjectException</span><span class="p">(</span><span class="s2">&quot;An error occurred when preparing an object.&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">ex</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/groups/group.py:1137,</span> in <span class="ni">CodeRunner.before_run</span><span class="nt">(self, run_namespace)</span>
<span class="g g-Whitespace">   </span><span class="mi">1136</span> <span class="k">def</span> <span class="nf">before_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_namespace</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1137</span>     <span class="bp">self</span><span class="o">.</span><span class="n">create_code_objects</span><span class="p">(</span><span class="n">run_namespace</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1138</span>     <span class="nb">super</span><span class="p">(</span><span class="n">CodeRunner</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">before_run</span><span class="p">(</span><span class="n">run_namespace</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/groups/group.py:1130,</span> in <span class="ni">CodeRunner.create_code_objects</span><span class="nt">(self, run_namespace)</span>
<span class="g g-Whitespace">   </span><span class="mi">1127</span> <span class="k">def</span> <span class="nf">create_code_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_namespace</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1128</span>     <span class="c1"># By default, we only have one code object for each CodeRunner.</span>
<span class="g g-Whitespace">   </span><span class="mi">1129</span>     <span class="c1"># Overwrite this function to use more than one.</span>
<span class="ne">-&gt; </span><span class="mi">1130</span>     <span class="n">code_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_default_code_object</span><span class="p">(</span><span class="n">run_namespace</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1131</span>     <span class="k">if</span> <span class="n">code_object</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1132</span>         <span class="bp">self</span><span class="o">.</span><span class="n">code_objects</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">weakref</span><span class="o">.</span><span class="n">proxy</span><span class="p">(</span><span class="n">code_object</span><span class="p">)]</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/groups/group.py:1112,</span> in <span class="ni">CodeRunner.create_default_code_object</span><span class="nt">(self, run_namespace)</span>
<span class="g g-Whitespace">   </span><span class="mi">1110</span>     <span class="bp">self</span><span class="o">.</span><span class="n">codeobj</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1111</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1112</span>     <span class="bp">self</span><span class="o">.</span><span class="n">codeobj</span> <span class="o">=</span> <span class="n">create_runner_codeobj</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1113</span>                                          <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">abstract_code</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1114</span>                                          <span class="n">user_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user_code</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1115</span>                                          <span class="n">template_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1116</span>                                          <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_codeobject*&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1117</span>                                          <span class="n">check_units</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">check_units</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1118</span>                                          <span class="n">additional_variables</span><span class="o">=</span><span class="n">additional_variables</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1119</span>                                          <span class="n">needed_variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">needed_variables</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1120</span>                                          <span class="n">run_namespace</span><span class="o">=</span><span class="n">run_namespace</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1121</span>                                          <span class="n">template_kwds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">template_kwds</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1122</span>                                          <span class="n">override_conditional_write</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">override_conditional_write</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1123</span>                                          <span class="n">codeobj_class</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codeobj_class</span>
<span class="g g-Whitespace">   </span><span class="mi">1124</span>                                          <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1125</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">codeobj</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/codegen/codeobject.py:435,</span> in <span class="ni">create_runner_codeobj</span><span class="nt">(group, code, template_name, run_namespace, user_code, variable_indices, name, check_units, needed_variables, additional_variables, template_kwds, override_conditional_write, codeobj_class)</span>
<span class="g g-Whitespace">    </span><span class="mi">432</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">var_index</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;_idx&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">433</span>         <span class="n">variables</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_variables</span><span class="p">[</span><span class="n">var_index</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">435</span> <span class="k">return</span> <span class="n">device</span><span class="o">.</span><span class="n">code_object</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>                           <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span>                           <span class="n">abstract_code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>                           <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>                           <span class="n">template_name</span><span class="o">=</span><span class="n">template_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">440</span>                           <span class="n">variable_indices</span><span class="o">=</span><span class="n">all_variable_indices</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>                           <span class="n">template_kwds</span><span class="o">=</span><span class="n">template_kwds</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span>                           <span class="n">codeobj_class</span><span class="o">=</span><span class="n">codeobj_class</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span>                           <span class="n">override_conditional_write</span><span class="o">=</span><span class="n">override_conditional_write</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">444</span>                           <span class="n">compiler_kwds</span><span class="o">=</span><span class="n">compiler_kwds</span>
<span class="g g-Whitespace">    </span><span class="mi">445</span>                           <span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/devices/device.py:324,</span> in <span class="ni">Device.code_object</span><span class="nt">(self, owner, name, abstract_code, variables, template_name, variable_indices, codeobj_class, template_kwds, override_conditional_write, compiler_kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span> <span class="n">logger</span><span class="o">.</span><span class="n">diagnostic</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> code:</span><span class="se">\n</span><span class="si">{</span><span class="n">indent</span><span class="p">(</span><span class="n">code_representation</span><span class="p">(</span><span class="n">code</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span> <span class="n">codeobj</span> <span class="o">=</span> <span class="n">codeobj_class</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">variable_indices</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>                         <span class="n">template_name</span><span class="o">=</span><span class="n">template_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>                         <span class="n">template_source</span><span class="o">=</span><span class="n">template</span><span class="o">.</span><span class="n">template_source</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>                         <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">compiler_kwds</span><span class="o">=</span><span class="n">compiler_kwds</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">324</span> <span class="n">codeobj</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span> <span class="k">return</span> <span class="n">codeobj</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/codegen/codeobject.py:100,</span> in <span class="ni">CodeObject.compile</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>     <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;before_run&#39;</span><span class="p">,</span> <span class="s1">&#39;run&#39;</span><span class="p">,</span> <span class="s1">&#39;after_run&#39;</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">100</span>         <span class="bp">self</span><span class="o">.</span><span class="n">compiled_code</span><span class="p">[</span><span class="n">block</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compile_block</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/codegen/runtime/cython_rt/cython_rt.py:139,</span> in <span class="ni">CythonCodeObject.compile_block</span><span class="nt">(self, block)</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span> <span class="ow">or</span> <span class="s1">&#39;EMPTY_CODE_BLOCK&#39;</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>     <span class="k">return</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">139</span> <span class="k">return</span> <span class="n">cython_extension_manager</span><span class="o">.</span><span class="n">create_extension</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span>     <span class="n">code</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">141</span>     <span class="n">define_macros</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">define_macros</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span>     <span class="n">libraries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">libraries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span>     <span class="n">extra_compile_args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extra_compile_args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span>     <span class="n">extra_link_args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extra_link_args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span>     <span class="n">include_dirs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">include_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span>     <span class="n">library_dirs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">library_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">147</span>     <span class="n">runtime_library_dirs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_library_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span>     <span class="n">compiler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compiler</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="n">owner_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>     <span class="n">sources</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>     <span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/codegen/runtime/cython_rt/extension_manager.py:116,</span> in <span class="ni">CythonExtensionManager.create_extension</span><span class="nt">(self, code, force, name, define_macros, include_dirs, library_dirs, runtime_library_dirs, extra_compile_args, extra_link_args, libraries, compiler, sources, owner_name)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>     <span class="n">lock</span> <span class="o">=</span> <span class="n">FileLock</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lib_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">.lock&quot;</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>     <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">116</span>         <span class="n">module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_module</span><span class="p">(</span><span class="n">module_path</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>                                    <span class="n">define_macros</span><span class="o">=</span><span class="n">define_macros</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span>                                    <span class="n">include_dirs</span><span class="o">=</span><span class="n">include_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span>                                    <span class="n">library_dirs</span><span class="o">=</span><span class="n">library_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>                                    <span class="n">extra_compile_args</span><span class="o">=</span><span class="n">extra_compile_args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span>                                    <span class="n">extra_link_args</span><span class="o">=</span><span class="n">extra_link_args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span>                                    <span class="n">libraries</span><span class="o">=</span><span class="n">libraries</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span>                                    <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span>                                    <span class="n">lib_dir</span><span class="o">=</span><span class="n">lib_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>                                    <span class="n">module_name</span><span class="o">=</span><span class="n">module_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>                                    <span class="n">runtime_library_dirs</span><span class="o">=</span><span class="n">runtime_library_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span>                                    <span class="n">compiler</span><span class="o">=</span><span class="n">compiler</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>                                    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span>                                    <span class="n">sources</span><span class="o">=</span><span class="n">sources</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span>     <span class="k">return</span> <span class="n">module</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/brian2/codegen/runtime/cython_rt/extension_manager.py:264,</span> in <span class="ni">CythonExtensionManager._load_module</span><span class="nt">(self, module_path, define_macros, include_dirs, library_dirs, extra_compile_args, extra_link_args, libraries, code, lib_dir, module_name, runtime_library_dirs, compiler, key, sources)</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span> <span class="n">build_extension</span><span class="o">.</span><span class="n">build_temp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyx_file</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span> <span class="n">build_extension</span><span class="o">.</span><span class="n">build_lib</span> <span class="o">=</span> <span class="n">lib_dir</span>
<span class="ne">--&gt; </span><span class="mi">264</span> <span class="n">build_extension</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">265</span> <span class="k">if</span> <span class="n">prefs</span><span class="p">[</span><span class="s1">&#39;codegen.runtime.cython.delete_source_files&#39;</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span>     <span class="c1"># we can delete the source files to save disk space</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span>     <span class="n">cpp_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lib_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">module_name</span><span class="si">}</span><span class="s2">.cpp&quot;</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/command/build_ext.py:346,</span> in <span class="ni">build_ext.run</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span>     <span class="bp">self</span><span class="o">.</span><span class="n">compiler</span><span class="o">.</span><span class="n">set_link_objects</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">link_objects</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span> <span class="c1"># Now actually compile and link everything.</span>
<span class="ne">--&gt; </span><span class="mi">346</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_extensions</span><span class="p">()</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/command/build_ext.py:468,</span> in <span class="ni">build_ext.build_extensions</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_build_extensions_parallel</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">468</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_build_extensions_serial</span><span class="p">()</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/command/build_ext.py:494,</span> in <span class="ni">build_ext._build_extensions_serial</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">492</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">493</span>     <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_build_errors</span><span class="p">(</span><span class="n">ext</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">494</span>         <span class="bp">self</span><span class="o">.</span><span class="n">build_extension</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/command/build_ext.py:549,</span> in <span class="ni">build_ext.build_extension</span><span class="nt">(self, ext)</span>
<span class="g g-Whitespace">    </span><span class="mi">546</span> <span class="k">for</span> <span class="n">undef</span> <span class="ow">in</span> <span class="n">ext</span><span class="o">.</span><span class="n">undef_macros</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">547</span>     <span class="n">macros</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">undef</span><span class="p">,))</span>
<span class="ne">--&gt; </span><span class="mi">549</span> <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compiler</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">550</span>     <span class="n">sources</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">551</span>     <span class="n">output_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">build_temp</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">552</span>     <span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">553</span>     <span class="n">include_dirs</span><span class="o">=</span><span class="n">ext</span><span class="o">.</span><span class="n">include_dirs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span>     <span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span>     <span class="n">extra_postargs</span><span class="o">=</span><span class="n">extra_args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span>     <span class="n">depends</span><span class="o">=</span><span class="n">ext</span><span class="o">.</span><span class="n">depends</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span> <span class="c1"># XXX outdated variable, kept here in case third-part code</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span> <span class="c1"># needs it.</span>
<span class="g g-Whitespace">    </span><span class="mi">561</span> <span class="bp">self</span><span class="o">.</span><span class="n">_built_objects</span> <span class="o">=</span> <span class="n">objects</span><span class="p">[:]</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/ccompiler.py:599,</span> in <span class="ni">CCompiler.compile</span><span class="nt">(self, sources, output_dir, macros, include_dirs, debug, extra_preargs, extra_postargs, depends)</span>
<span class="g g-Whitespace">    </span><span class="mi">597</span>     <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">598</span>         <span class="k">continue</span>
<span class="ne">--&gt; </span><span class="mi">599</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_compile</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">cc_args</span><span class="p">,</span> <span class="n">extra_postargs</span><span class="p">,</span> <span class="n">pp_opts</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">601</span> <span class="c1"># Return *all* object filenames, not just the ones we just built.</span>
<span class="g g-Whitespace">    </span><span class="mi">602</span> <span class="k">return</span> <span class="n">objects</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/unixccompiler.py:186,</span> in <span class="ni">UnixCCompiler._compile</span><span class="nt">(self, obj, src, ext, cc_args, extra_postargs, pp_opts)</span>
<span class="g g-Whitespace">    </span><span class="mi">184</span> <span class="n">compiler_so</span> <span class="o">=</span> <span class="n">compiler_fixup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compiler_so</span><span class="p">,</span> <span class="n">cc_args</span> <span class="o">+</span> <span class="n">extra_postargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">186</span>     <span class="bp">self</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="n">compiler_so</span> <span class="o">+</span> <span class="n">cc_args</span> <span class="o">+</span> <span class="p">[</span><span class="n">src</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_postargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span> <span class="k">except</span> <span class="n">DistutilsExecError</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span>     <span class="k">raise</span> <span class="n">CompileError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/ccompiler.py:1007,</span> in <span class="ni">CCompiler.spawn</span><span class="nt">(self, cmd, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1006</span> <span class="k">def</span> <span class="nf">spawn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1007</span>     <span class="n">spawn</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dry_run</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /usr/local/lib/python3.11/site-packages/setuptools/_distutils/spawn.py:58,</span> in <span class="ni">spawn</span><span class="nt">(cmd, search_path, verbose, dry_run, env)</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>     <span class="n">proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">58</span>     <span class="n">proc</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span>     <span class="n">exitcode</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">returncode</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>

<span class="nn">File /usr/local/Cellar/python@3.11/3.11.2_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/subprocess.py:1262,</span> in <span class="ni">Popen.wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1260</span>     <span class="n">endtime</span> <span class="o">=</span> <span class="n">_time</span><span class="p">()</span> <span class="o">+</span> <span class="n">timeout</span>
<span class="g g-Whitespace">   </span><span class="mi">1261</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1262</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1263</span> <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1264</span>     <span class="c1"># https://bugs.python.org/issue25942</span>
<span class="g g-Whitespace">   </span><span class="mi">1265</span>     <span class="c1"># The first keyboard interrupt waits briefly for the child to</span>
<span class="g g-Whitespace">   </span><span class="mi">1266</span>     <span class="c1"># exit under the common assumption that it also received the ^C</span>
<span class="g g-Whitespace">   </span><span class="mi">1267</span>     <span class="c1"># generated SIGINT and will exit rapidly.</span>
<span class="g g-Whitespace">   </span><span class="mi">1268</span>     <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /usr/local/Cellar/python@3.11/3.11.2_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/subprocess.py:1997,</span> in <span class="ni">Popen._wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">   </span><span class="mi">1995</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">returncode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1996</span>     <span class="k">break</span>  <span class="c1"># Another thread waited.</span>
<span class="ne">-&gt; </span><span class="mi">1997</span> <span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">sts</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_wait</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1998</span> <span class="c1"># Check the pid and loop as waitpid has been known to</span>
<span class="g g-Whitespace">   </span><span class="mi">1999</span> <span class="c1"># return 0 even without WNOHANG in odd situations.</span>
<span class="g g-Whitespace">   </span><span class="mi">2000</span> <span class="c1"># http://bugs.python.org/issue14396.</span>
<span class="g g-Whitespace">   </span><span class="mi">2001</span> <span class="k">if</span> <span class="n">pid</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">:</span>

<span class="nn">File /usr/local/Cellar/python@3.11/3.11.2_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/subprocess.py:1955,</span> in <span class="ni">Popen._try_wait</span><span class="nt">(self, wait_flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1953</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;All callers to this function MUST hold self._waitpid_lock.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1954</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1955</span>     <span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">sts</span><span class="p">)</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">waitpid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="n">wait_flags</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1956</span> <span class="k">except</span> <span class="ne">ChildProcessError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1957</span>     <span class="c1"># This happens if SIGCLD is set to be ignored or waiting</span>
<span class="g g-Whitespace">   </span><span class="mi">1958</span>     <span class="c1"># for child processes has otherwise been disabled for our</span>
<span class="g g-Whitespace">   </span><span class="mi">1959</span>     <span class="c1"># process.  This child is dead, we can&#39;t get the status.</span>
<span class="g g-Whitespace">   </span><span class="mi">1960</span>     <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Now if you’re running the notebook, you’ll see that this was a little slow to run. The reason is that for each loop, you’re recreating the objects from scratch. We can improve that by setting up the network just once. We store a copy of the state of the network before the loop, and restore it at the beginning of each iteration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span> 
<span class="n">num_inputs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">input_rate</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Hz</span>
<span class="n">weight</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tau_range</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">ms</span>
<span class="n">output_rates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Construct the network just once</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">input_rate</span><span class="p">)</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = -v/tau : 1</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;v += weight&#39;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="c1"># Store the current state of the network</span>
<span class="n">store</span><span class="p">()</span>
<span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">tau_range</span><span class="p">:</span>
    <span class="c1"># Restore the original state of the network</span>
    <span class="n">restore</span><span class="p">()</span>
    <span class="c1"># Run it with the new value of tau</span>
    <span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">second</span><span class="p">)</span>
    <span class="n">output_rates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">num_spikes</span><span class="o">/</span><span class="n">second</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tau_range</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">output_rates</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$ (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing rate (sp/s)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>That’s a very simple example of using store and restore, but you can use it in much more complicated situations. For example, you might want to run a long training run, and then run multiple test runs afterwards. Simply put a store after the long training run, and a restore before each testing run.</p>
<p>You can also see that the output curve is very noisy and doesn’t increase monotonically like we’d expect. The noise is coming from the fact that we run the Poisson group afresh each time. If we only wanted to see the effect of the time constant, we could make sure that the spikes were the same each time (although note that really, you ought to do multiple runs and take an average). We do this by running just the Poisson group once, recording its spikes, and then creating a new <code class="docutils literal notranslate"><span class="pre">SpikeGeneratorGroup</span></code> that will output those recorded spikes each time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span> 
<span class="n">num_inputs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">input_rate</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Hz</span>
<span class="n">weight</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tau_range</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">ms</span>
<span class="n">output_rates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Construct the Poisson spikes just once</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">input_rate</span><span class="p">)</span>
<span class="n">MP</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="c1"># We use a Network object because later on we don&#39;t</span>
<span class="c1"># want to include these objects</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">MP</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">second</span><span class="p">)</span>
<span class="c1"># And keep a copy of those spikes</span>
<span class="n">spikes_i</span> <span class="o">=</span> <span class="n">MP</span><span class="o">.</span><span class="n">i</span>
<span class="n">spikes_t</span> <span class="o">=</span> <span class="n">MP</span><span class="o">.</span><span class="n">t</span>
<span class="c1"># Now construct the network that we run each time</span>
<span class="c1"># SpikeGeneratorGroup gets the spikes that we created before</span>
<span class="n">SGG</span> <span class="o">=</span> <span class="n">SpikeGeneratorGroup</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">spikes_i</span><span class="p">,</span> <span class="n">spikes_t</span><span class="p">)</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = -v/tau : 1</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">SGG</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;v += weight&#39;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="c1"># Store the current state of the network</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">SGG</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>
<span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">tau_range</span><span class="p">:</span>
    <span class="c1"># Restore the original state of the network</span>
    <span class="n">net</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
    <span class="c1"># Run it with the new value of tau</span>
    <span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">second</span><span class="p">)</span>
    <span class="n">output_rates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">num_spikes</span><span class="o">/</span><span class="n">second</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tau_range</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">output_rates</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$ (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing rate (sp/s)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>You can see that now there is much less noise and it increases monotonically because the input spikes are the same each time, meaning we’re seeing the effect of the time constant, not the random spikes.</p>
<p>Note that in the code above, we created <code class="docutils literal notranslate"><span class="pre">Network</span></code> objects. The reason is that in the loop, if we just called <code class="docutils literal notranslate"><span class="pre">run</span></code> it would try to simulate all the objects, including the Poisson neurons <code class="docutils literal notranslate"><span class="pre">P</span></code>, and we only want to run that once. We use <code class="docutils literal notranslate"><span class="pre">Network</span></code> to specify explicitly which objects we want to include.</p>
<p>The techniques we’ve looked at so far are the conceptually most simple way to do multiple runs, but not always the most efficient. Since there’s only a single output neuron in the model above, we can simply duplicate that output neuron and make the time constant a parameter of the group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span> 
<span class="n">num_inputs</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">input_rate</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Hz</span>
<span class="n">weight</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">tau_range</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">*</span><span class="n">ms</span>
<span class="n">num_tau</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tau_range</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="n">input_rate</span><span class="p">)</span>
<span class="c1"># We make tau a parameter of the group</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = -v/tau : 1</span>
<span class="s1">tau : second</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="c1"># And we have num_tau output neurons, each with a different tau</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="n">num_tau</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="n">tau_range</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Synapses</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">on_pre</span><span class="o">=</span><span class="s1">&#39;v += weight&#39;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="c1"># Now we can just run once with no loop</span>
<span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">second</span><span class="p">)</span>
<span class="n">output_rates</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">count</span><span class="o">/</span><span class="n">second</span> <span class="c1"># firing rate is count/duration</span>
<span class="n">plot</span><span class="p">(</span><span class="n">tau_range</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">output_rates</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$ (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing rate (sp/s)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>You can see that this is much faster again! It’s a little bit more complicated conceptually, and it’s not always possible to do this trick, but it can be much more efficient if it’s possible.</p>
<p>Let’s finish with this example by having a quick look at how the mean and standard deviation of the interspike intervals depends on the time constant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trains</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">spike_trains</span><span class="p">()</span>
<span class="n">isi_mu</span> <span class="o">=</span> <span class="n">full</span><span class="p">(</span><span class="n">num_tau</span><span class="p">,</span> <span class="n">nan</span><span class="p">)</span><span class="o">*</span><span class="n">second</span>
<span class="n">isi_std</span> <span class="o">=</span> <span class="n">full</span><span class="p">(</span><span class="n">num_tau</span><span class="p">,</span> <span class="n">nan</span><span class="p">)</span><span class="o">*</span><span class="n">second</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tau</span><span class="p">):</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">trains</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">isi_mu</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
        <span class="n">isi_std</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">errorbar</span><span class="p">(</span><span class="n">tau_range</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">isi_mu</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">isi_std</span><span class="o">/</span><span class="n">ms</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$ (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Interspike interval (ms)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that we used the <code class="docutils literal notranslate"><span class="pre">spike_trains()</span></code> method of <code class="docutils literal notranslate"><span class="pre">SpikeMonitor</span></code>. This is a dictionary with keys being the indices of the neurons and values being the array of spike times for that neuron.</p>
</section>
<section id="changing-things-during-a-run">
<h2><span class="section-number">5.2. </span>Changing things during a run<a class="headerlink" href="#changing-things-during-a-run" title="Permalink to this heading">#</a></h2>
<p>Imagine an experiment where you inject current into a neuron, and change the amplitude randomly every 10 ms. Let’s see if we can model that using a Hodgkin-Huxley type neuron.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="c1"># Parameters</span>
<span class="n">area</span> <span class="o">=</span> <span class="mi">20000</span><span class="o">*</span><span class="n">umetre</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Cm</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">ufarad</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">gl</span> <span class="o">=</span> <span class="mf">5e-5</span><span class="o">*</span><span class="n">siemens</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">El</span> <span class="o">=</span> <span class="o">-</span><span class="mi">65</span><span class="o">*</span><span class="n">mV</span>
<span class="n">EK</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span><span class="o">*</span><span class="n">mV</span>
<span class="n">ENa</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="n">mV</span>
<span class="n">g_na</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">msiemens</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">g_kd</span> <span class="o">=</span> <span class="mi">30</span><span class="o">*</span><span class="n">msiemens</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">area</span>
<span class="n">VT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">63</span><span class="o">*</span><span class="n">mV</span>
<span class="c1"># The model</span>
<span class="n">eqs_HH</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (gl*(El-v) - g_na*(m*m*m)*h*(v-ENa) - g_kd*(n*n*n*n)*(v-EK) + I)/Cm : volt</span>
<span class="s1">dm/dt = 0.32*(mV**-1)*(13.*mV-v+VT)/</span>
<span class="s1">    (exp((13.*mV-v+VT)/(4.*mV))-1.)/ms*(1-m)-0.28*(mV**-1)*(v-VT-40.*mV)/</span>
<span class="s1">    (exp((v-VT-40.*mV)/(5.*mV))-1.)/ms*m : 1</span>
<span class="s1">dn/dt = 0.032*(mV**-1)*(15.*mV-v+VT)/</span>
<span class="s1">    (exp((15.*mV-v+VT)/(5.*mV))-1.)/ms*(1.-n)-.5*exp((10.*mV-v+VT)/(40.*mV))/ms*n : 1</span>
<span class="s1">dh/dt = 0.128*exp((17.*mV-v+VT)/(18.*mV))/ms*(1.-h)-4./(1+exp((40.*mV-v+VT)/(5.*mV)))/ms*h : 1</span>
<span class="s1">I : amp</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs_HH</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">refractory</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exponential_euler&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">El</span>
<span class="n">statemon</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">spikemon</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">group</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">50</span><span class="o">*</span><span class="n">nA</span>
    <span class="n">run</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
    <span class="n">axvline</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axhline</span><span class="p">(</span><span class="n">El</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">statemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">statemon</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">spikemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">spikemon</span><span class="o">.</span><span class="n">v</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v (mV)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>In the code above, we used a loop over multiple runs to achieve this. That’s fine, but it’s not the most efficient way to do it because each time we call <code class="docutils literal notranslate"><span class="pre">run</span></code> we have to do a lot of initialisation work that slows everything down. It also won’t work as well with the more efficient standalone mode of Brian. Here’s another way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs_HH</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">refractory</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exponential_euler&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">El</span>
<span class="n">statemon</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">spikemon</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="c1"># we replace the loop with a run_regularly</span>
<span class="n">group</span><span class="o">.</span><span class="n">run_regularly</span><span class="p">(</span><span class="s1">&#39;I = rand()*50*nA&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="c1"># we keep the loop just to draw the vertical lines</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axvline</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axhline</span><span class="p">(</span><span class="n">El</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">statemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">statemon</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">spikemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">spikemon</span><span class="o">.</span><span class="n">v</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v (mV)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>We’ve replaced the loop that had multiple <code class="docutils literal notranslate"><span class="pre">run</span></code> calls with a <code class="docutils literal notranslate"><span class="pre">run_regularly</span></code>. This makes the specified block of code run every <code class="docutils literal notranslate"><span class="pre">dt=10*ms</span></code>. The <code class="docutils literal notranslate"><span class="pre">run_regularly</span></code> lets you run code specific to a single <code class="docutils literal notranslate"><span class="pre">NeuronGroup</span></code>, but sometimes you might need more flexibility. For this, you can use <code class="docutils literal notranslate"><span class="pre">network_operation</span></code> which lets you run arbitrary Python code (but won’t work with the standalone mode).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs_HH</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">refractory</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exponential_euler&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">El</span>
<span class="n">statemon</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">spikemon</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="c1"># we replace the loop with a network_operation</span>
<span class="nd">@network_operation</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">change_I</span><span class="p">():</span>
    <span class="n">group</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">50</span><span class="o">*</span><span class="n">nA</span>
<span class="n">run</span><span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axvline</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axhline</span><span class="p">(</span><span class="n">El</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">statemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">statemon</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">spikemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">spikemon</span><span class="o">.</span><span class="n">v</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;ob&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v (mV)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s extend this example to run on multiple neurons, each with a different capacitance to see how that affects the behaviour of the cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">eqs_HH_2</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (gl*(El-v) - g_na*(m*m*m)*h*(v-ENa) - g_kd*(n*n*n*n)*(v-EK) + I)/C : volt</span>
<span class="s1">dm/dt = 0.32*(mV**-1)*(13.*mV-v+VT)/</span>
<span class="s1">    (exp((13.*mV-v+VT)/(4.*mV))-1.)/ms*(1-m)-0.28*(mV**-1)*(v-VT-40.*mV)/</span>
<span class="s1">    (exp((v-VT-40.*mV)/(5.*mV))-1.)/ms*m : 1</span>
<span class="s1">dn/dt = 0.032*(mV**-1)*(15.*mV-v+VT)/</span>
<span class="s1">    (exp((15.*mV-v+VT)/(5.*mV))-1.)/ms*(1.-n)-.5*exp((10.*mV-v+VT)/(40.*mV))/ms*n : 1</span>
<span class="s1">dh/dt = 0.128*exp((17.*mV-v+VT)/(18.*mV))/ms*(1.-h)-4./(1+exp((40.*mV-v+VT)/(5.*mV)))/ms*h : 1</span>
<span class="s1">I : amp</span>
<span class="s1">C : farad</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">eqs_HH_2</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">refractory</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exponential_euler&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">El</span>
<span class="c1"># initialise with some different capacitances</span>
<span class="n">group</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span><span class="o">*</span><span class="n">ufarad</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span><span class="o">*</span><span class="n">area</span>
<span class="n">statemon</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># we go back to run_regularly</span>
<span class="n">group</span><span class="o">.</span><span class="n">run_regularly</span><span class="p">(</span><span class="s1">&#39;I = rand()*50*nA&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axvline</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axhline</span><span class="p">(</span><span class="n">El</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">statemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">statemon</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v (mV)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>So that runs, but something looks wrong! The injected currents look like they’re different for all the different neurons! Let’s check:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">statemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">statemon</span><span class="o">.</span><span class="n">I</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">nA</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;I (nA)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Sure enough, it’s different each time. But why? We wrote <code class="docutils literal notranslate"><span class="pre">group.run_regularly('I</span> <span class="pre">=</span> <span class="pre">rand()*50*nA',</span> <span class="pre">dt=10*ms)</span></code> which seems like it should give the same value of I for each neuron. But, like threshold and reset statements, <code class="docutils literal notranslate"><span class="pre">run_regularly</span></code> code is interpreted as being run separately for each neuron, and because I is a parameter, it can be different for each neuron. We can fix this by making I into a <em>shared</em> variable, meaning it has the same value for each neuron.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">eqs_HH_3</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (gl*(El-v) - g_na*(m*m*m)*h*(v-ENa) - g_kd*(n*n*n*n)*(v-EK) + I)/C : volt</span>
<span class="s1">dm/dt = 0.32*(mV**-1)*(13.*mV-v+VT)/</span>
<span class="s1">    (exp((13.*mV-v+VT)/(4.*mV))-1.)/ms*(1-m)-0.28*(mV**-1)*(v-VT-40.*mV)/</span>
<span class="s1">    (exp((v-VT-40.*mV)/(5.*mV))-1.)/ms*m : 1</span>
<span class="s1">dn/dt = 0.032*(mV**-1)*(15.*mV-v+VT)/</span>
<span class="s1">    (exp((15.*mV-v+VT)/(5.*mV))-1.)/ms*(1.-n)-.5*exp((10.*mV-v+VT)/(40.*mV))/ms*n : 1</span>
<span class="s1">dh/dt = 0.128*exp((17.*mV-v+VT)/(18.*mV))/ms*(1.-h)-4./(1+exp((40.*mV-v+VT)/(5.*mV)))/ms*h : 1</span>
<span class="s1">I : amp (shared) # everything is the same except we&#39;ve added this shared</span>
<span class="s1">C : farad</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">eqs_HH_3</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">refractory</span><span class="o">=</span><span class="s1">&#39;v &gt; -40*mV&#39;</span><span class="p">,</span>
                    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exponential_euler&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">El</span>
<span class="n">group</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span><span class="o">*</span><span class="n">ufarad</span><span class="o">*</span><span class="n">cm</span><span class="o">**-</span><span class="mi">2</span><span class="o">*</span><span class="n">area</span>
<span class="n">statemon</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">run_regularly</span><span class="p">(</span><span class="s1">&#39;I = rand()*50*nA&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="mi">50</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axvline</span><span class="p">(</span><span class="n">l</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">axhline</span><span class="p">(</span><span class="n">El</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">statemon</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">statemon</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">mV</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v (mV)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Ahh, that’s more like it!</p>
</section>
<section id="adding-input">
<h2><span class="section-number">5.3. </span>Adding input<a class="headerlink" href="#adding-input" title="Permalink to this heading">#</a></h2>
<p>Now let’s think about a neuron being driven by a sinusoidal input. Let’s go back to a leaky integrate-and-fire to simplify the equations a bit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Hz</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">ms</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (I-v)/tau : 1</span>
<span class="s1">I = A*sin(2*pi*f*t) : 1</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;euler&#39;</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>So far, so good and the sort of thing we saw in the first tutorial. Now, what if that input current were something we had recorded and saved in a file? In that case, we can use <code class="docutils literal notranslate"><span class="pre">TimedArray</span></code>. Let’s start by reproducing the picture above but using <code class="docutils literal notranslate"><span class="pre">TimedArray</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Hz</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">ms</span>
<span class="c1"># Create a TimedArray and set the equations to use it</span>
<span class="n">t_recorded</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="n">ms</span><span class="o">/</span><span class="n">defaultclock</span><span class="o">.</span><span class="n">dt</span><span class="p">))</span><span class="o">*</span><span class="n">defaultclock</span><span class="o">.</span><span class="n">dt</span>
<span class="n">I_recorded</span> <span class="o">=</span> <span class="n">TimedArray</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">t_recorded</span><span class="p">),</span> <span class="n">dt</span><span class="o">=</span><span class="n">defaultclock</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (I-v)/tau : 1</span>
<span class="s1">I = I_recorded(t) : 1</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Note that for the example where we put the <code class="docutils literal notranslate"><span class="pre">sin</span></code> function directly in the equations, we had to use the <code class="docutils literal notranslate"><span class="pre">method='euler'</span></code> argument because the exact integrator wouldn’t work here (try it!). However, <code class="docutils literal notranslate"><span class="pre">TimedArray</span></code> is considered to be constant over its time step and so the linear integrator can be used. This means you won’t get the same behaviour from these two methods for two reasons. Firstly, the numerical integration methods <code class="docutils literal notranslate"><span class="pre">exact</span></code> and <code class="docutils literal notranslate"><span class="pre">euler</span></code> give slightly different results. Secondly, <code class="docutils literal notranslate"><span class="pre">sin</span></code> is not constant over a timestep whereas <code class="docutils literal notranslate"><span class="pre">TimedArray</span></code> is.</p>
<p>Now just to show that <code class="docutils literal notranslate"><span class="pre">TimedArray</span></code> works for arbitrary currents, let’s make a weird “recorded” current and run it on that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Hz</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">ms</span>
<span class="c1"># Let&#39;s create an array that couldn&#39;t be</span>
<span class="c1"># reproduced with a formula</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="n">ms</span><span class="o">/</span><span class="n">defaultclock</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="n">I_arr</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="n">I_arr</span><span class="p">[</span><span class="n">a</span><span class="p">:</span><span class="n">a</span><span class="o">+</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span>
<span class="n">I_recorded</span> <span class="o">=</span> <span class="n">TimedArray</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">I_arr</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">defaultclock</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (I-v)/tau : 1</span>
<span class="s1">I = I_recorded(t) : 1</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">StateMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, let’s finish on an example that actually reads in some data from a file. See if you can work out how this example works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_scope</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">matplotlib.image</span> <span class="kn">import</span> <span class="n">imread</span>
<span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;brian.png&#39;</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<span class="n">num_samples</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
<span class="n">ta</span> <span class="o">=</span> <span class="n">TimedArray</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span> <span class="c1"># 228</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">ms</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">dv/dt = (A*ta(t, i)-v)/tau+0.8*xi*tau**-0.5 : 1</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">NeuronGroup</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">eqs</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s1">&#39;v&gt;1&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="s1">&#39;v=0&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;euler&#39;</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">SpikeMonitor</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">run</span><span class="p">(</span><span class="n">num_samples</span><span class="o">*</span><span class="n">ms</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">t</span><span class="o">/</span><span class="n">ms</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
<span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Neuron index&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/week3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="week3b.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Introduction to Brian part 2: Synapses</p>
      </div>
    </a>
    <a class="right-next"
       href="../week4/week4a.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Introduction to Data Analysis with Pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-runs">5.1. Multiple runs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-things-during-a-run">5.2. Changing things during a run</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-input">5.3. Adding input</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Elias Najarro & Rune Berg
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <a href="https://neurowithpython.com/">neurowithpython.com</a> <div id="wh-modal"> <button class="wh-venti-button" aria-label="close modal" id="wh-modal-close">✕</button> <img id="wh-modal-img"> </div>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>